{"version":3,"names":["React","applyTriggerPropsToChildren","getTriggerChild","mergeCallbacks","useMergedRefs","useEventCallback","useModalAttributes","usePopoverContext_unstable","useARIAButtonProps","Escape","usePopoverTrigger_unstable","props","children","disableButtonEnhancement","child","open","context","setOpen","toggleOpen","triggerRef","openOnHover","openOnContext","triggerAttributes","onContextMenu","e","preventDefault","onClick","onKeyDown","key","stopPropagation","onMouseEnter","onMouseLeave","contextMenuProps","ref","triggerChildProps","ariaButtonTriggerChildProps","type"],"sources":["../../../src/components/PopoverTrigger/usePopoverTrigger.ts"],"sourcesContent":["import * as React from 'react';\nimport {\n  applyTriggerPropsToChildren,\n  getTriggerChild,\n  mergeCallbacks,\n  useMergedRefs,\n  useEventCallback,\n} from '@fluentui/react-utilities';\nimport { useModalAttributes } from '@fluentui/react-tabster';\nimport { usePopoverContext_unstable } from '../../popoverContext';\nimport type { PopoverTriggerProps, PopoverTriggerState } from './PopoverTrigger.types';\nimport { useARIAButtonProps } from '@fluentui/react-aria';\nimport { Escape } from '@fluentui/keyboard-keys';\n\n/**\n * Create the state required to render PopoverTrigger.\n *\n * The returned state can be modified with hooks such as usePopoverTriggerStyles,\n * before being passed to renderPopoverTrigger_unstable.\n *\n * @param props - props from this instance of PopoverTrigger\n */\nexport const usePopoverTrigger_unstable = (props: PopoverTriggerProps): PopoverTriggerState => {\n  const { children, disableButtonEnhancement = false } = props;\n  const child = getTriggerChild(children);\n\n  const open = usePopoverContext_unstable(context => context.open);\n  const setOpen = usePopoverContext_unstable(context => context.setOpen);\n  const toggleOpen = usePopoverContext_unstable(context => context.toggleOpen);\n  const triggerRef = usePopoverContext_unstable(context => context.triggerRef);\n  const openOnHover = usePopoverContext_unstable(context => context.openOnHover);\n  const openOnContext = usePopoverContext_unstable(context => context.openOnContext);\n  const { triggerAttributes } = useModalAttributes();\n\n  const onContextMenu = (e: React.MouseEvent<HTMLElement>) => {\n    if (openOnContext) {\n      e.preventDefault();\n      setOpen(e, true);\n    }\n  };\n\n  const onClick = (e: React.MouseEvent<HTMLElement>) => {\n    if (!openOnContext) {\n      toggleOpen(e);\n    }\n  };\n\n  const onKeyDown = (e: React.KeyboardEvent<HTMLElement>) => {\n    if (e.key === Escape && open) {\n      setOpen(e, false);\n      // stop propagation to avoid conflicting with other elements that listen for `Escape`\n      // e,g: Dialog, Menu\n      e.stopPropagation();\n    }\n  };\n\n  const onMouseEnter = (e: React.MouseEvent<HTMLElement>) => {\n    if (openOnHover) {\n      setOpen(e, true);\n    }\n  };\n\n  const onMouseLeave = (e: React.MouseEvent<HTMLElement>) => {\n    if (openOnHover) {\n      setOpen(e, false);\n    }\n  };\n\n  const contextMenuProps = {\n    ...triggerAttributes,\n    'aria-expanded': `${open}`,\n    ...child?.props,\n    onMouseEnter: useEventCallback(mergeCallbacks(child?.props.onMouseEnter, onMouseEnter)),\n    onMouseLeave: useEventCallback(mergeCallbacks(child?.props.onMouseLeave, onMouseLeave)),\n    onContextMenu: useEventCallback(mergeCallbacks(child?.props.onContextMenu, onContextMenu)),\n    ref: useMergedRefs(triggerRef, child?.ref),\n  } as const;\n\n  const triggerChildProps = {\n    ...contextMenuProps,\n    onClick: useEventCallback(mergeCallbacks(child?.props.onClick, onClick)),\n    onKeyDown: useEventCallback(mergeCallbacks(child?.props.onKeyDown, onKeyDown)),\n  };\n\n  const ariaButtonTriggerChildProps = useARIAButtonProps(\n    child?.type === 'button' || child?.type === 'a' ? child.type : 'div',\n    triggerChildProps,\n  );\n\n  return {\n    children: applyTriggerPropsToChildren(\n      props.children,\n      useARIAButtonProps(\n        child?.type === 'button' || child?.type === 'a' ? child.type : 'div',\n        openOnContext ? contextMenuProps : disableButtonEnhancement ? triggerChildProps : ariaButtonTriggerChildProps,\n      ),\n    ),\n  };\n};\n"],"mappings":"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"}