{"version":3,"names":["useMergedRefs","React","useHTMLElementWalkerRef","useRovingTabIndex","filter","currentElementRef","useRef","walkerRef","rootRef","rootRefCallback","element","reset","current","walker","currentElement","root","tabbableChild","firstChild","tabIndex","NodeFilter","FILTER_ACCEPT","FILTER_SKIP","process","env","NODE_ENV","console","warn","nextElement","rove","focus"],"sources":["../../src/hooks/useRovingTabIndexes.ts"],"sourcesContent":["import { useMergedRefs } from '@fluentui/react-utilities';\nimport * as React from 'react';\nimport { HTMLElementFilter, useHTMLElementWalkerRef } from './useHTMLElementWalker';\n\n/**\n * https://www.w3.org/WAI/ARIA/apg/practices/keyboard-interface/#kbd_roving_tabindex\n */\nexport function useRovingTabIndex(filter?: HTMLElementFilter) {\n  const currentElementRef = React.useRef<HTMLElement>();\n  const [walkerRef, rootRef] = useHTMLElementWalkerRef(filter);\n\n  const rootRefCallback = (element?: HTMLElement) => {\n    if (!element) {\n      return;\n    }\n    reset();\n  };\n\n  function reset() {\n    if (!walkerRef.current) {\n      return;\n    }\n    const walker = walkerRef.current;\n    walker.currentElement = walker.root;\n    let tabbableChild = walker.firstChild(element =>\n      element.tabIndex === 0 ? NodeFilter.FILTER_ACCEPT : NodeFilter.FILTER_SKIP,\n    );\n    walker.currentElement = walker.root;\n    tabbableChild ??= walker.firstChild();\n    if (!tabbableChild) {\n      if (process.env.NODE_ENV === 'development') {\n        // eslint-disable-next-line no-console\n        console.warn('useRovingTabIndexes: internal error, no tabbable element was found');\n      }\n      return;\n    }\n    tabbableChild.tabIndex = 0;\n    currentElementRef.current = tabbableChild;\n    let nextElement: HTMLElement | null = null;\n    while ((nextElement = walker.nextElement()) && nextElement !== tabbableChild) {\n      nextElement.tabIndex = -1;\n    }\n  }\n  function rove(nextElement: HTMLElement) {\n    if (!currentElementRef.current) {\n      return;\n    }\n    currentElementRef.current.tabIndex = -1;\n    nextElement.tabIndex = 0;\n    nextElement.focus();\n    currentElementRef.current = nextElement;\n  }\n\n  return [\n    {\n      rove,\n      reset,\n    },\n    useMergedRefs(rootRef, rootRefCallback) as React.Ref<HTMLElement>,\n  ] as const;\n}\n"],"mappings":"AAAA,SAASA,aAAa,QAAQ;AAC9B,YAAYC,KAAA,MAAW;AACvB,SAA4BC,uBAAuB,QAAQ;AAE3D;;;AAGA,OAAO,SAASC,kBAAkBC,MAA0B,EAAE;EAC5D,MAAMC,iBAAA,GAAoBJ,KAAA,CAAMK,MAAM;EACtC,MAAM,CAACC,SAAA,EAAWC,OAAA,CAAQ,GAAGN,uBAAA,CAAwBE,MAAA;EAErD,MAAMK,eAAA,GAAmBC,OAAA,IAA0B;IACjD,IAAI,CAACA,OAAA,EAAS;MACZ;IACF;IACAC,KAAA;EACF;EAEA,SAASA,MAAA,EAAQ;IACf,IAAI,CAACJ,SAAA,CAAUK,OAAO,EAAE;MACtB;IACF;IACA,MAAMC,MAAA,GAASN,SAAA,CAAUK,OAAO;IAChCC,MAAA,CAAOC,cAAc,GAAGD,MAAA,CAAOE,IAAI;IACnC,IAAIC,aAAA,GAAgBH,MAAA,CAAOI,UAAU,CAACP,OAAA,IACpCA,OAAA,CAAQQ,QAAQ,KAAK,IAAIC,UAAA,CAAWC,aAAa,GAAGD,UAAA,CAAWE,WAAW;IAE5ER,MAAA,CAAOC,cAAc,GAAGD,MAAA,CAAOE,IAAI;IACnCC,aAAA,aAAAA,aAAA,cAAAA,aAAA,GAAAA,aAAA,GAAkBH,MAAA,CAAOI,UAAU,EAAE;IACrC,IAAI,CAACD,aAAA,EAAe;MAClB,IAAIM,OAAA,CAAQC,GAAG,CAACC,QAAQ,KAAK,eAAe;QAC1C;QACAC,OAAA,CAAQC,IAAI,CAAC;MACf;MACA;IACF;IACAV,aAAA,CAAcE,QAAQ,GAAG;IACzBb,iBAAA,CAAkBO,OAAO,GAAGI,aAAA;IAC5B,IAAIW,WAAA,GAAkC,IAAI;IAC1C,OAAO,CAACA,WAAA,GAAcd,MAAA,CAAOc,WAAW,EAAC,KAAMA,WAAA,KAAgBX,aAAA,EAAe;MAC5EW,WAAA,CAAYT,QAAQ,GAAG,CAAC;IAC1B;EACF;EACA,SAASU,KAAKD,WAAwB,EAAE;IACtC,IAAI,CAACtB,iBAAA,CAAkBO,OAAO,EAAE;MAC9B;IACF;IACAP,iBAAA,CAAkBO,OAAO,CAACM,QAAQ,GAAG,CAAC;IACtCS,WAAA,CAAYT,QAAQ,GAAG;IACvBS,WAAA,CAAYE,KAAK;IACjBxB,iBAAA,CAAkBO,OAAO,GAAGe,WAAA;EAC9B;EAEA,OAAO,CACL;IACEC,IAAA;IACAjB;EACF,GACAX,aAAA,CAAcQ,OAAA,EAASC,eAAA,EACxB;AACH"}