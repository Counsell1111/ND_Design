{"version":3,"names":["React","getNativeElementProps","useEventCallback","useMergedRefs","useTreeContext_unstable","useNestedTreeNavigation","useOpenItemsState","treeDataTypes","useTree_unstable","props","ref","isSubtree","ctx","level","useSubtree","useRootTree","contextAppearance","appearance","contextSize","size","parentLevel","openItems","requestOpenChange","requestNavigation","components","root","role","warnIfNoProperPropsRootTree","updateOpenItems","navigate","navigationRef","data","_props_onOpenChange","onOpenChange","call","event","isDefaultPrevented","_props_onNavigation_unstable","onNavigation_unstable","type","arrowDown","arrowUp","preventDefault","process","env","NODE_ENV","console","warn"],"sources":["../../../src/components/Tree/useTree.ts"],"sourcesContent":["import * as React from 'react';\nimport { getNativeElementProps, useEventCallback, useMergedRefs } from '@fluentui/react-utilities';\nimport { TreeOpenChangeData, TreeProps, TreeState, TreeNavigationData_unstable } from './Tree.types';\nimport { useTreeContext_unstable } from '../../contexts';\nimport { useNestedTreeNavigation, useOpenItemsState } from '../../hooks';\nimport { treeDataTypes } from '../../utils/tokens';\n\n/**\n * Create the state required to render Tree.\n *\n * The returned state can be modified with hooks such as useTreeStyles_unstable,\n * before being passed to renderTree_unstable.\n *\n * @param props - props from this instance of Tree\n * @param ref - reference to root HTMLElement of Tree\n */\nexport const useTree_unstable = (props: TreeProps, ref: React.Ref<HTMLElement>): TreeState => {\n  const isSubtree = useTreeContext_unstable(ctx => ctx.level > 0);\n  // as isSubtree is static, this doesn't break rule of hooks\n  // and if this becomes an issue later on, this can be easily converted\n  // eslint-disable-next-line react-hooks/rules-of-hooks\n  return isSubtree ? useSubtree(props, ref) : useRootTree(props, ref);\n};\n\n/**\n * Create the state required to render a sub-level Tree.\n *\n * @param props - props from this instance of Tree\n * @param ref - reference to root HTMLElement of Tree\n */\nfunction useSubtree(props: TreeProps, ref: React.Ref<HTMLElement>): TreeState {\n  const contextAppearance = useTreeContext_unstable(ctx => ctx.appearance);\n  const contextSize = useTreeContext_unstable(ctx => ctx.size);\n\n  const { appearance = contextAppearance ?? 'subtle', size = contextSize ?? 'medium' } = props;\n\n  const parentLevel = useTreeContext_unstable(ctx => ctx.level);\n  const openItems = useTreeContext_unstable(ctx => ctx.openItems);\n  const requestOpenChange = useTreeContext_unstable(ctx => ctx.requestOpenChange);\n  const requestNavigation = useTreeContext_unstable(ctx => ctx.requestNavigation);\n\n  return {\n    components: {\n      root: 'div',\n    },\n    appearance,\n    size,\n    level: parentLevel + 1,\n    root: getNativeElementProps('div', {\n      ref,\n      role: 'group',\n      ...props,\n    }),\n    openItems,\n    requestOpenChange,\n    requestNavigation,\n  };\n}\n\n/**\n * Create the state required to render the root level Tree.\n *\n * @param props - props from this instance of Tree\n * @param ref - reference to root HTMLElement of Tree\n */\nfunction useRootTree(props: TreeProps, ref: React.Ref<HTMLElement>): TreeState {\n  warnIfNoProperPropsRootTree(props);\n\n  const { appearance = 'subtle', size = 'medium' } = props;\n\n  const [openItems, updateOpenItems] = useOpenItemsState(props);\n  const [navigate, navigationRef] = useNestedTreeNavigation();\n\n  const requestOpenChange = useEventCallback((data: TreeOpenChangeData) => {\n    props.onOpenChange?.(data.event, data);\n    if (data.event.isDefaultPrevented()) {\n      return;\n    }\n    return updateOpenItems(data);\n  });\n\n  const requestNavigation = useEventCallback((data: TreeNavigationData_unstable) => {\n    props.onNavigation_unstable?.(data.event, data);\n    if (data.event.isDefaultPrevented()) {\n      return;\n    }\n    navigate(data);\n    if (data.type === treeDataTypes.arrowDown || data.type === treeDataTypes.arrowUp) {\n      data.event.preventDefault();\n    }\n  });\n\n  return {\n    components: {\n      root: 'div',\n    },\n    appearance,\n    size,\n    level: 1,\n    openItems,\n    requestOpenChange,\n    requestNavigation,\n    root: getNativeElementProps('div', {\n      ref: useMergedRefs(navigationRef, ref),\n      role: 'tree',\n      ...props,\n    }),\n  };\n}\n\nfunction warnIfNoProperPropsRootTree(props: Pick<TreeProps, 'aria-label' | 'aria-labelledby'>) {\n  if (process.env.NODE_ENV === 'development') {\n    if (!props['aria-label'] && !props['aria-labelledby']) {\n      // eslint-disable-next-line no-console\n      console.warn('Tree must have either a `aria-label` or `aria-labelledby` property defined');\n    }\n  }\n}\n"],"mappings":"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"}