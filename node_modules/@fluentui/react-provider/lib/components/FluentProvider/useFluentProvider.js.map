{"version":3,"names":["useFocusVisible","ThemeContext_unstable","ThemeContext","useFluent_unstable","useFluent","useOverrides_unstable","useOverrides","useCustomStyleHooks_unstable","useCustomStyleHooks","getNativeElementProps","useMergedRefs","React","useFluentProviderThemeStyleTag","useRenderer_unstable","useFluentProvider_unstable","props","ref","parentContext","parentTheme","useTheme","parentOverrides","parentCustomStyleHooks","applyStylesToPortals","customStyleHooks_unstable","dir","targetDocument","theme","overrides_unstable","overrides","mergedTheme","shallowMerge","mergedOverrides","mergedCustomStyleHooks","useEffect","process","env","NODE_ENV","undefined","console","warn","renderer","_renderer_styleElementAttributes","styleTagId","rule","rendererAttributes","styleElementAttributes","themeClassName","components","root","serverStyleProps","cssRule","attributes","id","a","b","useContext"],"sources":["../../../src/components/FluentProvider/useFluentProvider.ts"],"sourcesContent":["import { useFocusVisible } from '@fluentui/react-tabster';\nimport {\n  ThemeContext_unstable as ThemeContext,\n  useFluent_unstable as useFluent,\n  useOverrides_unstable as useOverrides,\n  useCustomStyleHooks_unstable as useCustomStyleHooks,\n} from '@fluentui/react-shared-contexts';\nimport type {\n  CustomStyleHooksContextValue_unstable as CustomStyleHooksContextValue,\n  ThemeContextValue_unstable as ThemeContextValue,\n} from '@fluentui/react-shared-contexts';\n\nimport { getNativeElementProps, useMergedRefs } from '@fluentui/react-utilities';\nimport * as React from 'react';\nimport { useFluentProviderThemeStyleTag } from './useFluentProviderThemeStyleTag';\nimport type { FluentProviderProps, FluentProviderState } from './FluentProvider.types';\nimport { useRenderer_unstable } from '@griffel/react';\n\n/**\n * Create the state required to render FluentProvider.\n *\n * The returned state can be modified with hooks such as useFluentProviderStyles_unstable,\n * before being passed to renderFluentProvider_unstable.\n *\n * @param props - props from this instance of FluentProvider\n * @param ref - reference to root HTMLElement of FluentProvider\n */\nexport const useFluentProvider_unstable = (\n  props: FluentProviderProps,\n  ref: React.Ref<HTMLElement>,\n): FluentProviderState => {\n  const parentContext = useFluent();\n  const parentTheme = useTheme();\n  const parentOverrides = useOverrides();\n  const parentCustomStyleHooks = useCustomStyleHooks();\n\n  /**\n   * TODO: add merge functions to \"dir\" merge,\n   * nesting providers with the same \"dir\" should not add additional attributes to DOM\n   * see https://github.com/microsoft/fluentui/blob/0dc74a19f3aa5a058224c20505016fbdb84db172/packages/fluentui/react-northstar/src/utils/mergeProviderContexts.ts#L89-L93\n   */\n  const {\n    applyStylesToPortals = true,\n    // eslint-disable-next-line @typescript-eslint/naming-convention\n    customStyleHooks_unstable,\n    dir = parentContext.dir,\n    targetDocument = parentContext.targetDocument,\n    theme,\n    overrides_unstable: overrides = {},\n  } = props;\n  const mergedTheme = shallowMerge(parentTheme, theme);\n\n  const mergedOverrides = shallowMerge(parentOverrides, overrides);\n\n  // parentCustomStyleHooks will not be a partial\n  const mergedCustomStyleHooks = shallowMerge(\n    parentCustomStyleHooks,\n    customStyleHooks_unstable,\n  ) as CustomStyleHooksContextValue;\n\n  React.useEffect(() => {\n    if (process.env.NODE_ENV !== 'production' && mergedTheme === undefined) {\n      // eslint-disable-next-line no-console\n      console.warn(`\n      FluentProvider: your \"theme\" is not defined !\n      =============================================\n      Make sure your root FluentProvider has set a theme or you're setting the theme in your child FluentProvider.\n      `);\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n\n  const renderer = useRenderer_unstable();\n  const { styleTagId, rule } = useFluentProviderThemeStyleTag({\n    theme: mergedTheme,\n    targetDocument,\n    rendererAttributes: renderer.styleElementAttributes ?? {},\n  });\n  return {\n    applyStylesToPortals,\n    // eslint-disable-next-line @typescript-eslint/naming-convention\n    customStyleHooks_unstable: mergedCustomStyleHooks,\n    dir,\n    targetDocument,\n    theme: mergedTheme,\n    // eslint-disable-next-line @typescript-eslint/naming-convention\n    overrides_unstable: mergedOverrides,\n    themeClassName: styleTagId,\n\n    components: {\n      root: 'div',\n    },\n\n    root: getNativeElementProps('div', {\n      ...props,\n      dir,\n      ref: useMergedRefs(ref, useFocusVisible<HTMLDivElement>({ targetDocument })),\n    }),\n\n    serverStyleProps: {\n      cssRule: rule,\n      attributes: {\n        ...renderer.styleElementAttributes,\n        id: styleTagId,\n      },\n    },\n  };\n};\n\nfunction shallowMerge<T>(a: T, b: T): T {\n  // Merge impacts perf: we should like to avoid it if it's possible\n  if (a && b) {\n    return { ...a, ...b };\n  }\n\n  if (a) {\n    return a;\n  }\n\n  return b;\n}\n\nfunction useTheme(): ThemeContextValue {\n  return React.useContext(ThemeContext);\n}\n"],"mappings":"AAAA,SAASA,eAAe,QAAQ;AAChC,SACEC,qBAAA,IAAyBC,YAAY,EACrCC,kBAAA,IAAsBC,SAAS,EAC/BC,qBAAA,IAAyBC,YAAY,EACrCC,4BAAA,IAAgCC,mBAAmB,QAC9C;AAMP,SAASC,qBAAqB,EAAEC,aAAa,QAAQ;AACrD,YAAYC,KAAA,MAAW;AACvB,SAASC,8BAA8B,QAAQ;AAE/C,SAASC,oBAAoB,QAAQ;AAErC;;;;;;;;;AASA,OAAO,MAAMC,0BAAA,GAA6BA,CACxCC,KAAA,EACAC,GAAA,KACwB;EACxB,MAAMC,aAAA,GAAgBb,SAAA;EACtB,MAAMc,WAAA,GAAcC,QAAA;EACpB,MAAMC,eAAA,GAAkBd,YAAA;EACxB,MAAMe,sBAAA,GAAyBb,mBAAA;EAE/B;;;;;EAKA,MAAM;IACJc,oBAAA,GAAuB,IAAI;IAC3B;IACAC,yBAAA;IACAC,GAAA,GAAMP,aAAA,CAAcO,GAAG;IACvBC,cAAA,GAAiBR,aAAA,CAAcQ,cAAc;IAC7CC,KAAA;IACAC,kBAAA,EAAoBC,SAAA,GAAY,CAAC;EAAC,CACnC,GAAGb,KAAA;EACJ,MAAMc,WAAA,GAAcC,YAAA,CAAaZ,WAAA,EAAaQ,KAAA;EAE9C,MAAMK,eAAA,GAAkBD,YAAA,CAAaV,eAAA,EAAiBQ,SAAA;EAEtD;EACA,MAAMI,sBAAA,GAAyBF,YAAA,CAC7BT,sBAAA,EACAE,yBAAA;EAGFZ,KAAA,CAAMsB,SAAS,CAAC,MAAM;IACpB,IAAIC,OAAA,CAAQC,GAAG,CAACC,QAAQ,KAAK,gBAAgBP,WAAA,KAAgBQ,SAAA,EAAW;MACtE;MACAC,OAAA,CAAQC,IAAI,CAAE;;;;OAIb;IACH;IACA;EACF,GAAG,EAAE;EAEL,MAAMC,QAAA,GAAW3B,oBAAA;MAIK4B,gCAAA;EAHtB,MAAM;IAAEC,UAAA;IAAYC;EAAI,CAAE,GAAG/B,8BAAA,CAA+B;IAC1Dc,KAAA,EAAOG,WAAA;IACPJ,cAAA;IACAmB,kBAAA,EAAoB,CAAAH,gCAAA,GAAAD,QAAA,CAASK,sBAAsB,cAA/BJ,gCAAA,cAAAA,gCAAA,GAAmC,CAAC;EAC1D;EACA,OAAO;IACLnB,oBAAA;IACA;IACAC,yBAAA,EAA2BS,sBAAA;IAC3BR,GAAA;IACAC,cAAA;IACAC,KAAA,EAAOG,WAAA;IACP;IACAF,kBAAA,EAAoBI,eAAA;IACpBe,cAAA,EAAgBJ,UAAA;IAEhBK,UAAA,EAAY;MACVC,IAAA,EAAM;IACR;IAEAA,IAAA,EAAMvC,qBAAA,CAAsB,OAAO;MACjC,GAAGM,KAAK;MACRS,GAAA;MACAR,GAAA,EAAKN,aAAA,CAAcM,GAAA,EAAKhB,eAAA,CAAgC;QAAEyB;MAAe;IAC3E;IAEAwB,gBAAA,EAAkB;MAChBC,OAAA,EAASP,IAAA;MACTQ,UAAA,EAAY;QACV,GAAGX,QAAA,CAASK,sBAAsB;QAClCO,EAAA,EAAIV;MACN;IACF;EACF;AACF;AAEA,SAASZ,aAAgBuB,CAAI,EAAEC,CAAI,EAAK;EACtC;EACA,IAAID,CAAA,IAAKC,CAAA,EAAG;IACV,OAAO;MAAE,GAAGD,CAAC;MAAE,GAAGC;IAAE;EACtB;EAEA,IAAID,CAAA,EAAG;IACL,OAAOA,CAAA;EACT;EAEA,OAAOC,CAAA;AACT;AAEA,SAASnC,SAAA,EAA8B;EACrC,OAAOR,KAAA,CAAM4C,UAAU,CAACrD,YAAA;AAC1B"}